var t,e;import{w as s,i,g as n,p as a,r,a as o,o as c,b as l,s as u,c as d,S as p,d as f,e as h,f as b,h as m,j as g,t as w,k as v,l as y,m as $,n as N,q as I,u as S,v as D,x,y as E,z as T,A as k,B as A,C as P,D as L,E as O,F as U,G as M,H as B,I as j,J as R,K as z,L as G}from"./vendor.7c95c9ed.js";const V=(t,e)=>localStorage.setItem(t,`${e}`),C=(()=>{let t=((t,e)=>{const s=localStorage.getItem(t);return null===s?e:"true"==s})("notify",!1);const{subscribe:e,set:i}=s(t);return{subscribe:e,set(e){if(e){(()=>{if(!("Notification"in window))return alert("This browser does not support desktop notification"),!1;if("granted"===Notification.permission){const t=new Notification("Notifications enabled");return setTimeout((()=>t.close()),1400),V("notify",!0),!0}return"denied"!==Notification.permission&&Notification.requestPermission((function(t){if("granted"===t){const t=new Notification("Notifications enabled");return setTimeout((()=>t.close()),1400),V("notify",!0),!0}})),alert("Could not enable notifications"),!1})()?(i(!0),t=!0):(setTimeout((()=>i(!1)),2e3),t=!1)}else V("notify",!1),i(!1),t=!1},showNotification(){if(!t)return;const e=new Notification("Switch Driver!",{icon:"notification-icon.png"});setTimeout((()=>e.close()),2500)}}})();window.name=window.name||(new Date).toISOString();const F=window.name;try{i({apiKey:"AIzaSyDJfeIN2N8fPSVzOIjw1vlRANsRG_zj8WY",authDomain:"pairing-timer.firebaseapp.com",projectId:"pairing-timer",storageBucket:"pairing-timer.appspot.com",messagingSenderId:"961812360178",appId:"1:961812360178:web:e96ca5961212b97698196b",databaseURL:" https://pairing-timer-default-rtdb.europe-west1.firebasedatabase.app"})}catch(pt){if(!pt.toString().includes("Firebase App named '[DEFAULT]' already exists"))throw pt}const q=n();let J=null==(e=null==(t=window.location.hash)?void 0:t.split("#"))?void 0:e[1];const K={start:null,status:"STOPPED",cycleMinutes:.05,participants:[F]},H="/timers";if(J)o(r(q,`${H}/${J}/participants`),(t=>t?t.includes(F)?t:[...t,F]:[F]));else{const{key:t}=a(r(q,H),K);J=t,window.location.hash=J}const W=r(q,`${H}/${J}/participants`),Y=r(q,`${H}/${J}/cycleMinutes`),_=r(q,`${H}/${J}/repeat`),Q=r(q,`${H}/${J}/start`),X=r(q,`${H}/${J}/status`),Z=(()=>{const{subscribe:t,set:e}=s(K.participants);let i=K.participants;return c(W,(t=>{i=t.val(),e(i)})),window.addEventListener("beforeunload",(async t=>(t.preventDefault(),1===i.length?await l(r(q,`${H}/${J}`)):await(t=>{o(r(q,`${H}/${t}/participants`),(t=>{if(t)return t.filter((t=>t!==F))}))})(J),null))),{subscribe:t}})(),tt=(()=>{const{subscribe:t,set:e}=s(K.cycleMinutes);return c(Y,(t=>e(t.val()))),{subscribe:t,set(t){console.log({value:t}),u(Y,t)}}})(),et=(()=>{const{subscribe:t,set:e}=s(!0);return c(_,(t=>e(t.val()))),{subscribe:t,set(t){console.log({value:t}),u(_,t),V("repeat",t)}}})(),st=(()=>{const{subscribe:t,set:e}=s(K.start);return c(Q,(t=>e((t=>{if(t){var e=t.split(/\D+/);return new Date(Date.UTC(e[0],--e[1],e[2],e[3],e[4],e[5],e[6]))}})(t.val())))),{subscribe:t,set:e}})(),it=(()=>{const{subscribe:t,set:e}=s(K.status);return c(X,(t=>e(t.val()))),{subscribe:t,set:e}})(),nt=async()=>{const t=new Date;it.set("RUNNING"),st.set(t),u(Q,t.toISOString()),u(X,"RUNNING")},at=async()=>{it.set("STOPPED"),st.set(null),u(X,"STOPPED"),u(Q,null)},rt=d(new Date,(t=>{const e=setInterval((()=>t(new Date)),1e3);return()=>clearInterval(e)}));class ot extends p{constructor(t){super(),f(this,t,null,null,h,{})}}function ct(t){let e,s,i,n;return{c(){e=g("button"),s=w("Start"),this.h()},l(t){e=$(t,"BUTTON",{class:!0});var i=N(e);s=I(i,"Start"),i.forEach(S),this.h()},h(){D(e,"class","bg-green-500 py-2 px-4 text-2xl text-white")},m(t,a){E(t,e,a),T(e,s),i||(n=A(e,"click",nt),i=!0)},p:G,d(t){t&&S(e),i=!1,n()}}}function lt(t){let e,s,i,n;return{c(){e=g("button"),s=w("Stop"),this.h()},l(t){e=$(t,"BUTTON",{class:!0});var i=N(e);s=I(i,"Stop"),i.forEach(S),this.h()},h(){D(e,"class","bg-red-500 py-2 px-4 text-2xl text-white")},m(t,a){E(t,e,a),T(e,s),i||(n=A(e,"click",at),i=!0)},p:G,d(t){t&&S(e),i=!1,n()}}}function ut(t){let e,s,i,n,a,r,o,c,l,u,d,p,f,h,j,R,z,G,V,C,F,q,J,K,H,W=t[6](t[0])+"";function Y(t,e){return t[3]?lt:ct}e=new ot({});let _=Y(t),Q=_(t);return{c(){b(e.$$.fragment),s=m(),i=g("main"),n=g("div"),a=g("div"),r=w(W),o=m(),Q.c(),c=m(),l=g("div"),u=g("label"),d=g("input"),p=w("Minutes"),f=m(),h=g("label"),j=g("input"),R=w("Repeat"),z=m(),G=g("label"),V=g("input"),C=w("Notification"),F=m(),q=w(t[1]),this.h()},l(b){v(e.$$.fragment,b),s=y(b),i=$(b,"MAIN",{class:!0});var m=N(i);n=$(m,"DIV",{class:!0});var g=N(n);a=$(g,"DIV",{class:!0});var w=N(a);r=I(w,W),w.forEach(S),o=y(g),Q.l(g),c=y(g),l=$(g,"DIV",{class:!0});var D=N(l);u=$(D,"LABEL",{for:!0});var x=N(u);d=$(x,"INPUT",{class:!0,type:!0}),p=I(x,"Minutes"),x.forEach(S),f=y(D),h=$(D,"LABEL",{for:!0});var E=N(h);j=$(E,"INPUT",{id:!0,type:!0,class:!0}),R=I(E,"Repeat"),E.forEach(S),z=y(D),G=$(D,"LABEL",{for:!0});var T=N(G);V=$(T,"INPUT",{id:!0,class:!0,type:!0}),C=I(T,"Notification"),T.forEach(S),D.forEach(S),F=y(g),q=I(g,t[1]),g.forEach(S),m.forEach(S),this.h()},h(){D(a,"class","mb-4 text-5xl"),D(d,"class","mr-2 w-14 border border-indigo-500 pl-2"),D(d,"type","number"),D(u,"for","time"),D(j,"id","repeat"),D(j,"type","checkbox"),D(j,"class","mr-2"),D(h,"for","repeat"),D(V,"id","notify"),D(V,"class","mr-2"),D(V,"type","checkbox"),D(G,"for","notify"),D(l,"class","flex flex-col my-8"),D(n,"class","mt-20"),D(i,"class","flex justify-center align-middle")},m(b,m){x(e,b,m),E(b,s,m),E(b,i,m),T(i,n),T(n,a),T(a,r),T(n,o),Q.m(n,null),T(n,c),T(n,l),T(l,u),T(u,d),k(d,t[2]),T(u,p),T(l,f),T(l,h),T(h,j),j.checked=t[4],T(h,R),T(l,z),T(l,G),T(G,V),V.checked=t[5],T(G,C),T(n,F),T(n,q),J=!0,K||(H=[A(d,"input",t[10]),A(j,"change",t[11]),A(V,"change",t[12])],K=!0)},p(t,[e]){(!J||1&e)&&W!==(W=t[6](t[0])+"")&&P(r,W),_===(_=Y(t))&&Q?Q.p(t,e):(Q.d(1),Q=_(t),Q&&(Q.c(),Q.m(n,c))),4&e&&L(d.value)!==t[2]&&k(d,t[2]),16&e&&(j.checked=t[4]),32&e&&(V.checked=t[5]),(!J||2&e)&&P(q,t[1])},i(t){J||(O(e.$$.fragment,t),J=!0)},o(t){U(e.$$.fragment,t),J=!1},d(t){M(e,t),t&&S(s),t&&S(i),Q.d(),K=!1,B(H)}}}function dt(t,e,s){let i,n,a,r,o,c,l,u,d;j(t,rt,(t=>s(8,a=t))),j(t,Z,(t=>s(9,r=t))),j(t,tt,(t=>s(2,o=t))),j(t,st,(t=>s(3,c=t))),j(t,et,(t=>s(4,l=t))),j(t,C,(t=>s(5,u=t))),R((()=>p(0))),st.subscribe((t=>{s(7,d=t?z(t,60*o):void 0)}));const p=(t=1)=>{if(!(new Audio).canPlayType("audio/mp3"))return;const e=new Audio("beep.mp3");e.volume=t,e.play()};return t.$$.update=()=>{384&t.$$.dirty&&s(0,i=d?new Date(Number(d)-Number(a)):void 0),1&t.$$.dirty&&(null==i?void 0:i.getTime())<=0&&(console.log("finished",{start:null==c?void 0:c.toISOString(),jetzt:a.toISOString()}),C.showNotification(),p(),l?nt():at()),512&t.$$.dirty&&s(1,n=(null==r?void 0:r.length)<=1?"Nobody is watching the timer besides you. Invite others by sharing the link!":2===r.length?"Another person is watching the timer with you":r.length-1+" other people are watching the timer with you")},[i,n,o,c,l,u,t=>{if(!t)return"00:00";return`${t.getMinutes()<10?`0${t.getMinutes()}`:t.getMinutes()}:${t.getSeconds()<10?`0${t.getSeconds()}`:t.getSeconds()}`},d,a,r,function(){o=L(this.value),tt.set(o)},function(){l=this.checked,et.set(l)},function(){u=this.checked,C.set(u)}]}new class extends p{constructor(t){super(),f(this,t,dt,ut,h,{})}}({target:document.getElementById("app")});
